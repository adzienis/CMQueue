

<% if @course and !@course.new_record? %>

  <% content_for :content do %>
    <%= turbo_stream_from @course %>

    <%= tag.div id: "course-status", data: {
      courseId: @course.id
    }.to_json do %>
    <% end if current_user.staff_of?(@course) %>

    <div class="<%= current_user.staff_of?(@course) ? 'sidebar' : '' %>" style="display: flex; flex-direction: row; ">
      <% if current_user.staff_of?(@course) %>
        <% content_for :nav_content do %>
          <div class="dropdown">
            <button class="btn btn-light dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
              <%= session[:semester].nil? ? "All Semesters" : session[:semester] %>
            </button>
            <ul class="dropdown-menu">
              <li>
                <%= link_to "All Semesters", semester_course_path(@course), class: "dropdown-item", method: :post %>
              </li>
              <% Enrollment.semesters.values.each do |sem| %>
                <li>
                  <%= link_to sem, semester_course_path(@course, semester: sem), class: "dropdown-item", method: :post %>
                </li>
              <% end %>
            </ul>
          </div>
        <% end if false %>


        <%= render partial: "shared/course_sidebar" %>
        <button class="btn btn-outline-secondary sidebar-opener" onclick="event.preventDefault(); toggle()">
          <i class="fas fa-chevron-right"></i>
        </button>

      <% end %>
      <div id='courses-container' class="container mt-4 mb-5" style="min-height: 100vh">
        <%= content_for?(:courses_content) ? yield(:courses_content) : yield %>
      </div>
    </div>
  <% end %>

  <%= render template: "layouts/application" %>
<% elsif params[:user_id] %>
  <%= render template: "layouts/users" %>
<% end %>